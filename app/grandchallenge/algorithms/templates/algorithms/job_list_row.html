{% load url %}
{% load profiles %}
{% load workstations %}
{% load guardian_tags %}
{% load pathlib %}
{% load humanize %}
{% load remove_whitespace %}
{% load dict_lookup %}
{% load meta_attr %}

<a class="badge badge-primary"
   href="{% url 'algorithms:job-detail' slug=algorithm.slug pk=object.pk %}"
   title="View result details">
    <i class="fa fa-info-circle"></i>
    Detail
</a>
<split></split>

{{ object.created|naturaltime }}
<split></split>

{{ object.creator|user_profile_link }}
<split></split>

<span class="badge badge-{{ object.status_context }}">
    {% if object.animate %}
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
    {% endif %}
    {{ object.get_status_display }}{% if object.status == object.SUCCESS and object.stderr %},
        with warnings{% endif %}
</span>
<split></split>

{% if object.public %}
    <i class="fa fa-eye text-success"
       title="Result and images are public"></i>
{% else %}
    {% if object.viewers.user_set.all|length > 1 %}
        {# TODO: Hack, we need to exclude the creator rather than checking the length is > 1 #}
        <i class="fa fa-eye text-warning"
           title="Result and images are visible by {{ object.viewers.user_set.all|oxford_comma }}"></i>
    {% else %}
        <i class="fa fa-eye-slash text-danger"
           title="Result and images are private"></i>
    {% endif %}
{% endif %}
<split></split>

{{ object.comment }}
<split></split>

PLACEHOLDER: results
<split></split>

{% if object.status == object.SUCCESS %}
    <button class="btn badge badge-primary"
            title="View algorithm result"
            {% workstation_session_control_data workstation=algorithm.workstation context_object=algorithm algorithm_job=object config=algorithm.workstation_config %}
>
        <i class="fa fa-eye"></i> Open Result in Viewer
    </button>
{% endif %}
<split></split>
