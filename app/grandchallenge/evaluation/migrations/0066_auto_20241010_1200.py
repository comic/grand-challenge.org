# Generated by Django 4.2.16 on 2024-10-10 12:00

from django.db import migrations


def set_requirements_from_active_method(apps, schema_editor):
    Method = apps.get_model("evaluation", "Method")  # noqa: N806

    for method in Method.objects.filter(is_desired_version=True):
        phase = method.phase

        phase.evaluation_requires_memory_gb = method.requires_memory_gb

        if method.requires_gpu:
            phase.evaluation_requires_gpu_type = method.desired_gpu_type
        else:
            phase.evaluation_requires_gpu_type = ""

        phase.save()


class Migration(migrations.Migration):

    dependencies = [
        ("evaluation", "0065_phase_evaluation_requires_gpu_type_and_more"),
    ]

    operations = [
        migrations.RunPython(
            set_requirements_from_active_method, elidable=True
        ),
    ]
