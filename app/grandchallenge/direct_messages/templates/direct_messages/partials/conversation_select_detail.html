{% load url %}

<div class="d-flex w-100 justify-content-between">
    <h6 class="mb-1">
        {% for participant in object.participants.all %}
            {% if participant != request.user %}
                <img class="rounded-circle align-middle"
                     src="{{ participant.user_profile.get_mugshot_url }}"
                     alt="User Mugshot" style="height: 1.33em"/>&nbsp;
                <b>{{ participant.first_name }}&nbsp;{{ participant.last_name }}</b>&nbsp;({{ participant.username }})
            {% endif %}
        {% endfor %}
    </h6>

    {% if object.unread_by_user %}
        <span class="text-danger">
                <i class="fa fa-xs fa-circle"></i>
            </span>
    {% endif %}
</div>

<p class="mb-1">
    {% if object.direct_messages.first.sender == request.user %}
        You:
    {% else %}
        {{ object.direct_messages.first.sender.first_name }}:
    {% endif %}
    {{ object.direct_messages.first.message|truncatewords:4 }}
</p>

<small>{{ object.direct_messages.first.created }}</small>

{% if object.unread_by_user %}
    <form class="conversation-mark-read-form"
            action="{% url 'direct-messages:conversation-mark-read' pk=object.pk %}" method="post">
        {% csrf_token %}
    </form>
{% endif %}
